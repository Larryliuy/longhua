$(function(){function e(e){var t=!1;!function(i){for(var n=e.find("input"),s=0;s<n.length;s++)n.eq(s).change(function(){$(this).parents("table").find("input:checked").length==n.length&&(t=!0);var e=$(this).parents(".query_house").prev().find("input");t?(e.prop("checked",this.checked),t=!1):e.prop("checked",!1),this.checked||$("#checkAll").prop("checked",this.checked)})}()}$("input").click(function(e){e.stopPropagation()}),$("label").click(function(e){e.stopPropagation()}),$(".modelTypeDelete").find("li:first-child a").next().addClass("query_house_active"),$(".modelTypeDelete").find("li:first-child a").addClass("lastLiner"),$(".modelTypeDelete").find("li:last-child").addClass("lastLiner"),$(".modelTypeDelete").find("li:first-child img").attr("src","/resources/img/simulation/packup.png"),function(){for(var e=$("a.list_title"),t=($("a.list_title span"),0);t<e.length;t++)e.eq(t).click(function(e){e.stopPropagation();var t=$(this).children("span").children();"/resources/img/simulation/packup.png"!=t.attr("src")?(t.attr("src","/resources/img/simulation/packup.png"),$(this).next().show(),$(this).addClass("lastLiner"),$(this).parent().siblings().find(".lastLiner").removeClass("lastLiner")):(t.attr("src","/resources/img/simulation/unfold.png"),$(this).next().hide(),$(this).removeClass("lastLiner")),$(this).parent().siblings().children("a").next().hide(),$(this).parent().siblings().children("a").find("span").children().attr("src","/resources/img/img_long/unfold.png")})}(),$("#checkAll").change(function(){for(var e=$(".archives_list ul").find("input"),t=0;t<e.length;t++)e.eq(t).prop("checked",this.checked)}),$(".list_title").find("input").change(function(){this.checked||$("#checkAll").prop("checked",this.checked);for(var e=$(this).parents("a").next().find("input"),t=0;t<e.length;t++)e.eq(t).prop("checked",this.checked)}),function(){for(var t=$(".modelTypeDelete").find("table"),i=0;i<t.length;i++)e(t.eq(i))}(),$(".deleteModel").click(function(){var e=$(".list_title").find("input"),t=$(".list_title").find("input:checked"),i=$(".query_house table").find("input:checked");if($("#checkAll").prop("checked")){if(!confirm("确定删除吗？"))return;for(var n="[",s=0;s<e.length;s++)n+='{"typeId":"'+(l=parseInt(t.eq(s).prop("id").substring(4)))+'"},',e.eq(s).parents(".list_title").parent().remove();n=n.substring(0,n.length-1)+"]",$.post("/simulation/model/batchRemove",{typeJson:n},function(e){var t=JSON.parse(e);alert(t.msg)}),$(".archives_list ul").empty()}else if(0!=t.length){if(!confirm("确定删除吗？"))return;for(var r=0,n="[",s=0;s<t.length;s++)n+='{"typeId":"'+(l=t.eq(s).prop("id").substring(4))+'"},',t.eq(s).parents(".list_title").parent().remove();if(n=n.substring(0,n.length-1)+"]",$.ajaxSetup({async:!1}),$.post("/simulation/model/batchRemove",{typeJson:n},function(e){100==JSON.parse(e).state&&(r=1)}),0!=(i=$(".query_house table").find("input:checked")).length){for(var n="[",s=0;s<i.length;s++)n+='{"modelId":"'+(l=i.eq(s).prop("id").substring(5))+'"},',i.eq(s).parents("td").remove();n=n.substring(0,n.length-1)+"]",$.post("/simulation/model/batchRemove",{modelJson:n},function(e){var t=JSON.parse(e);console.log(t),100==t.state&&(r=1==r?3:2)})}switch(r){case 0:alert("删除失败");break;case 1:alert("删除成功");break;case 2:alert("部分删除成功");break;case 3:alert("删除成功");break;default:alert("未知错误")}}else if(0!=i.length){if(!confirm("确定删除吗？"))return;for(var n="[",s=0;s<i.length;s++){var l=i.eq(s).prop("id").substring(5);n+='{"modelId":"'+l+'"},',i.eq(s).parents("td").remove()}n=n.substring(0,n.length-1)+"]",$.post("/simulation/model/batchRemove",{modelJson:n},function(e){var t=JSON.parse(e);alert(t.msg)})}else alert("请勾选需要删除的模型!")}),$(".modelTypeDelete").css("height",parseInt(window.innerHeight)-135+"px"),window.onresize=function(){$(".modelTypeDelete").css("height",parseInt(window.innerHeight)-135+"px")}});