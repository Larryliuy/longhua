$(function(){function e(){"238px"==$(".content_query").css("width")?($(".retract").css("left","0%"),$(".content_query_complex").css("display","flex"),$(".retract p").text(">>")):($(".retract").css("left","238px"),$(".content_query_complex").css("display","none"),$(".retract p").text("<<"))}function t(){$(".saveExe").show(),$.post("/simulation/type/getAll",{createUserId:1},function(e){var t=JSON.parse(e).result,n="";$(".classicExe").empty();for(var i=0;i<t.length;i++)n+="<option value = "+t[i].id+">"+t[i].name+"</option>";$(".classicExe").append(n)})}var n="";n=function(){var e,t,n,i="",a=new Date;switch(e=a.getFullYear(),t=a.getMonth()+1,n=a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),week=a.getDay(),week){case 0:i="星期天";break;case 1:i="星期一";break;case 2:i="星期二";break;case 3:i="星期三";break;case 4:i="星期四";break;case 5:i="星期五";break;case 6:i="星期六"}return"今天是"+e+"年"+t+"月"+n+"日 | "+i}(),$(".header_nav_date p").text(n),$(".more").mouseenter(function(){$(".more_content").hide()}),$(".more_content").mouseenter(function(){$(".more_content").hide()}),$(".more_content").mouseout(function(){$(".more_content").hide()}),$(".advance_search").click(function(){$(".content_query_complex").hide(),$(".content_query").css("width","238px"),e()}),$(".complex_search").change(function(){alert("综合查询")}),$(".retract").click(function(){"238px"!=$(".content_query").css("width")?$(".content_query").css("width","238px"):($(".content_query").css("display","flex"),$(".content_query").css("width","0px")),e()}),function(){$(".list_title").click(function(){$(this).next("div").toggleClass("query_house_active"),$(this).next().hasClass("query_house_active")?($(this).addClass("lastLiner"),$(this).parent().siblings().find(".lastLiner").removeClass("lastLiner")):$(this).removeClass("lastLiner"),$(this).parent().siblings().children("div.query_house").removeClass("query_house_active"),$(this).addClass("list_title_active"),$(this).parent().siblings().children("a").removeClass("list_title_active")});var e=$("a.list_title");for(var t in e)e.eq(t).click(function(){var e=$(this).children("span").children();"/resources/img/img_long/packup.png"!=e.attr("src")?e.attr("src","/resources/img/img_long/packup.png"):e.attr("src","/resources/img/img_long/unfold.png"),$(this).parent().siblings().children("a").find("span").children().attr("src","/resources/img/img_long/unfold.png")});$(".add").unbind().click(function(){var e=$(this).parents(".query_house").prev().find("b").text();window.location.href=encodeURI("/simulation/model/page/add?"+e)}),$(".modelType").find("li:first-child a").next().addClass("query_house_active"),$(".modelType").find("li:first-child a").addClass("lastLiner"),$(".modelType").find("li:last-child").addClass("lastLiner"),$(".modelType").find("li:first-child").children("img").attr("src","/resources/img/img_long/packup.png")}(),function(){for(var e=$(".modelType").find("table"),t=0;t<e.length;t++)!function(e){for(var t=e.find("td"),n="",i="",a="",s=0;s<t.length-1;s++)n=t.eq(s).attr("modelurl"),i=t.eq(s).attr("modelimg"),i=n+i.substring(i.indexOf(",")+1,i.length),t.eq(s).children("img").attr("src",i);e.find("td").click(function(){var e={};n=$(this).attr("modelurl"),a=$(this).attr("modelimg").substring(0,$(this).attr("modelimg").indexOf(",")),e.url=n+a,e.type="simulation_addmodel",window.parent.sendToMap(e)})}(e.eq(t))}();try{window.parent.showSubmit()}catch(e){}$(".historical_archives").click(function(){try{window.parent.closeSimulation()}catch(e){}window.location.href="/simulation/page/recordList"}),$(".modelManagement").click(function(){try{window.parent.closeSimulation()}catch(e){}window.location.href="/simulation/model/page/modelManagement"}),0==$(".modelType").find("li").length&&($(".modelType").append('<tr><td class="add" style=\'margin-left: 100px;margin-top: 50px;display: block;text-align: center;cursor: pointer\'><img src="/resources/img/simulation/add.png"/><p>添加</p></td></tr>'),$(".add").unbind().click(function(){window.location.href="/simulation/model/page/add"})),$(".modelType").css("height",parseInt(window.innerHeight)-90+"px"),window.onresize=function(){var e=$(parent.frames.query_iframe).height()-90+"px";$(".modelType").css("height",e)};var i="";$(".confirmBtn").click(function(){var e=$("#ExeName").val(),t=$(".classicExe").val();if(""!=e&&null!=e&&32!=e.charCodeAt()){$(".saveExe").hide();var n={type:"simulation_submit",name:e,typeId:t,createUserId:1,dataJson:i};$.post("/simulation/save",n,function(e){var t=JSON.parse(e);100==t.state&&window.parent.sendToMap({type:"reset"}),alert(t.msg)})}else alert("请输入正确的名称")}),window.addEventListener("message",function(e){if("http://geo.longmap.com"==e.origin){var n=JSON.parse(e.data);"simulation_submit"==n.type&&(console.log(n),i=n.dataJson,t())}},!0)});