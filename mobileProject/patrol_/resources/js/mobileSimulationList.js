$(function(){function e(e,i){$.post(e,i,function(e){if(e){var i=JSON.parse(e);alert(i.msg),100==i.state&&t()}})}function t(){$.post("/simulation/type/getAll",{createUserId:""},function(e){var t=JSON.parse(e).result;if(0!=t.length){for(var i="",n=0,o=t.length;n<o;n++)i+='<li class="item" value = '+t[n].id+'><div class="itemTitle">'+t[n].name+'</div><div><img src="../../../resources/img/mobile/st_menu.png"></div></li>';$(".simulationType").empty().append(i)}else $(".simulationType").append('<li style="text-align: center;color: #666666">暂无数据</li>')})}var i=-1,n="",o=window.innerWidth,a=window.innerHeight;window.onresize=function(){o=window.innerWidth,a=window.innerHeight},$(".addType").on("touchend",function(e){$(".popBox").children("p").remove(),$(".popBox").children("input").remove(),$(".editTitle").text("添加分类").after('<input type="text" placeholder="请输入分类">'),$(".bgGray").show()}),t(),$(".simulationType").on("touchmove",function(e){console.log(e)}),$(".simulationType").on("tap",function(e){var t=o-e.target.offsetLeft+10,a=e.target.offsetTop;i=$(e.target).val()||$(e.target).parents("li").val(),n=$(e.target).parent().prev().text()||$(e.target).text(),console.log(n),"IMG"==e.target.nodeName&&($(".st_edit").css("right",t).css("top",a).show(),e.stopPropagation()),("LI"==e.target.nodeName||$(e.target).hasClass("itemTitle"))&&(console.log(e.target.nodeName),window.location.href=encodeURI("/mobile/simulationRecord?"+i+"&"+n))}),$(".st_edit").on("touchend",function(e){switch($(e.target).text()){case"编辑":$(".popBox").children("p").remove(),$(".popBox").children("input").remove(),$(".editTitle").text("修改分类").after('<input type="text" placeholder="请输入分类">'),$(".bgGray").show();break;case"删除":$(".popBox").children("p").remove(),$(".popBox").children("input").remove(),$(".editTitle").text("确认删除").after("<p>确定删除‘"+n+"’吗?</p>"),$(".bgGray").show();break;case"取消":$(this).hide();break;default:i=-1}e.preventDefault()}),$("body").on("touchstart",function(e){"none"!=$(".st_edit").css("display")&&($(".st_edit").hide(),e.stopPropagation())}),$(".bgGray").width(window.innerWidth).height(window.screen.height),$(".bgGray").on("touchstart",function(e){$(this).on("touchmove",function(e){e.preventDefault()})}),$(".bgGray").on("touchend",function(t){if("BUTTON"==t.target.nodeName){if("确 定"==t.target.innerHTML)switch($(this).find(".editTitle").text()){case"确认删除":e("/simulation/type/remove",{id:i});break;case"添加分类":e("/simulation/type/add",{name:n=$(this).find("input").val(),remark:"",createUserId:""});break;case"修改分类":var n=$(this).find("input").val();e("/simulation/type/update",{name:n,remark:"",id:i})}else if("取 消"==t.target.innerHTML){var o=$(this).find("input")||null;o&&o.blur()}$(this).hide()}})}),window.onunload=function(){};